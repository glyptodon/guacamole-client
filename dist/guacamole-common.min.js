/*
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or implied.  See the License for the
 * specific language governing permissions and limitations
 * under the License.
 */
var Guacamole=Guacamole||{}
Guacamole.ArrayBufferReader=function(e){var t=this
e.onblob=function(e){for(var n=window.atob(e),a=new ArrayBuffer(n.length),r=new Uint8Array(a),o=0;o<n.length;o++)r[o]=n.charCodeAt(o)
t.ondata&&t.ondata(a)},e.onend=function(){t.onend&&t.onend()},this.ondata=null,this.onend=null},Guacamole.ArrayBufferWriter=function(e){function t(t){for(var n="",a=0;a<t.byteLength;a++)n+=String.fromCharCode(t[a])
e.sendBlob(window.btoa(n))}var n=this
e.onack=function(e){n.onack&&n.onack(e)},this.blobLength=Guacamole.ArrayBufferWriter.DEFAULT_BLOB_LENGTH,this.sendData=function(e){var a=new Uint8Array(e)
if(a.length<=n.blobLength)t(a)
else for(var r=0;r<a.length;r+=n.blobLength)t(a.subarray(r,r+n.blobLength))},this.sendEnd=function(){e.sendEnd()},this.onack=null},Guacamole.ArrayBufferWriter.DEFAULT_BLOB_LENGTH=6048,Guacamole.AudioContextFactory={singleton:null,getAudioContext:function(){var e=window.AudioContext||window.webkitAudioContext
if(e)try{return Guacamole.AudioContextFactory.singleton||(Guacamole.AudioContextFactory.singleton=new e),Guacamole.AudioContextFactory.singleton}catch(t){}return null}},Guacamole.AudioPlayer=function(){this.sync=function(){}},Guacamole.AudioPlayer.isSupportedType=function(e){return Guacamole.RawAudioPlayer.isSupportedType(e)},Guacamole.AudioPlayer.getSupportedTypes=function(){return Guacamole.RawAudioPlayer.getSupportedTypes()},Guacamole.AudioPlayer.getInstance=function(e,t){return Guacamole.RawAudioPlayer.isSupportedType(t)?new Guacamole.RawAudioPlayer(e,t):null},Guacamole.RawAudioPlayer=function(e,t){var n=Guacamole.RawAudioFormat.parse(t),a=Guacamole.AudioContextFactory.getAudioContext(),r=a.currentTime,o=new Guacamole.ArrayBufferReader(e),i=.02,u=.3,s=1===n.bytesPerSample?window.Int8Array:window.Int16Array,l=1===n.bytesPerSample?128:32768,c=[],d=function(e){if(e.length<=1)return e[0]
var t=0
e.forEach(function(e){t+=e.length})
var n=0,a=new s(t)
return e.forEach(function(e){a.set(e,n),n+=e.length}),a},f=function(e){for(var t=Number.MAX_VALUE,a=e.length,r=Math.floor(e.length/n.channels),o=Math.floor(n.rate*i),u=Math.max(n.channels*o,n.channels*(r-o)),l=u;l<e.length;l+=n.channels){for(var c=0,d=0;d<n.channels;d++)c+=Math.abs(e[l+d])
t>=c&&(a=l+n.channels,t=c)}return a===e.length?[e]:[new s(e.buffer.slice(0,a*n.bytesPerSample)),new s(e.buffer.slice(a*n.bytesPerSample))]},h=function(e){c.push(new s(e))},p=function(){var e=d(c)
return e?(c=f(e),e=c.shift()):null},m=function(e){var t=e.length/n.channels,o=a.currentTime
o>r&&(r=o)
for(var i=a.createBuffer(n.channels,t,n.rate),u=0;u<n.channels;u++)for(var s=i.getChannelData(u),c=u,d=0;t>d;d++)s[d]=e[c]/l,c+=n.channels
return i}
o.ondata=function(e){h(new s(e))
var t=p()
if(t){var o=a.currentTime
o>r&&(r=o)
var i=a.createBufferSource()
i.connect(a.destination),i.start||(i.start=i.noteOn),i.buffer=m(t),i.start(r),r+=t.length/n.channels/n.rate}},this.sync=function(){var e=a.currentTime
r=Math.min(r,e+u)}},Guacamole.RawAudioPlayer.prototype=new Guacamole.AudioPlayer,Guacamole.RawAudioPlayer.isSupportedType=function(e){return Guacamole.AudioContextFactory.getAudioContext()?null!==Guacamole.RawAudioFormat.parse(e):!1},Guacamole.RawAudioPlayer.getSupportedTypes=function(){return Guacamole.AudioContextFactory.getAudioContext()?["audio/L8","audio/L16"]:[]},Guacamole.AudioRecorder=function(){this.onclose=null,this.onerror=null},Guacamole.AudioRecorder.isSupportedType=function(e){return Guacamole.RawAudioRecorder.isSupportedType(e)},Guacamole.AudioRecorder.getSupportedTypes=function(){return Guacamole.RawAudioRecorder.getSupportedTypes()},Guacamole.AudioRecorder.getInstance=function(e,t){return Guacamole.RawAudioRecorder.isSupportedType(t)?new Guacamole.RawAudioRecorder(e,t):null},Guacamole.RawAudioRecorder=function(e,t){var n=this,a=2048,r=3,o=Guacamole.RawAudioFormat.parse(t),i=Guacamole.AudioContextFactory.getAudioContext(),u=(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia).bind(navigator),s=new Guacamole.ArrayBufferWriter(e),l=1===o.bytesPerSample?window.Int8Array:window.Int16Array,c=1===o.bytesPerSample?128:32768,d=0,f=0,h=null,p=null,m=null,v=function(e){if(0===e)return 1
var t=Math.PI*e
return Math.sin(t)/t},g=function(e,t){return e>-t&&t>e?v(e)*v(e/t):0},y=function(e,t){for(var n=(e.length-1)*t,a=Math.floor(n)-r+1,o=Math.floor(n)+r,i=0,u=a;o>=u;u++)i+=(e[u]||0)*g(n-u,r)
return i},w=function(e){var t=e.length
d+=t
var n=Math.round(d*o.rate/e.sampleRate),a=n-f
f+=a
for(var r=new l(a*o.channels),i=0;i<o.channels;i++)for(var u=e.getChannelData(i),s=i,h=0;a>h;h++)r[s]=y(u,h/(a-1))*c,s+=o.channels
return r},S=function(){u({audio:!0},function(e){m=i.createScriptProcessor(a,o.channels,o.channels),m.connect(i.destination),m.onaudioprocess=function(e){s.sendData(w(e.inputBuffer).buffer)},p=i.createMediaStreamSource(e),p.connect(m),h=e},function(){s.sendEnd(),n.onerror&&n.onerror()})},b=function(){if(p&&p.disconnect(),m&&m.disconnect(),h)for(var e=h.getTracks(),t=0;t<e.length;t++)e[t].stop()
m=null,p=null,h=null,s.sendEnd()}
s.onack=function(e){e.code!==Guacamole.Status.Code.SUCCESS||h?(b(),s.onack=null,e.code===Guacamole.Status.Code.RESOURCE_CLOSED?n.onclose&&n.onclose():n.onerror&&n.onerror()):S()}},Guacamole.RawAudioRecorder.prototype=new Guacamole.AudioRecorder,Guacamole.RawAudioRecorder.isSupportedType=function(e){return Guacamole.AudioContextFactory.getAudioContext()?null!==Guacamole.RawAudioFormat.parse(e):!1},Guacamole.RawAudioRecorder.getSupportedTypes=function(){return Guacamole.AudioContextFactory.getAudioContext()?["audio/L8","audio/L16"]:[]},Guacamole.BlobReader=function(e,t){var n,a=this,r=0
n=window.BlobBuilder?new BlobBuilder:window.WebKitBlobBuilder?new WebKitBlobBuilder:window.MozBlobBuilder?new MozBlobBuilder:new function(){var e=[]
this.append=function(n){e.push(new Blob([n],{type:t}))},this.getBlob=function(){return new Blob(e,{type:t})}},e.onblob=function(t){for(var o=window.atob(t),i=new ArrayBuffer(o.length),u=new Uint8Array(i),s=0;s<o.length;s++)u[s]=o.charCodeAt(s)
n.append(i),r+=i.byteLength,a.onprogress&&a.onprogress(i.byteLength),e.sendAck("OK",0)},e.onend=function(){a.onend&&a.onend()},this.getLength=function(){return r},this.getBlob=function(){return n.getBlob()},this.onprogress=null,this.onend=null},Guacamole.BlobWriter=function(e){var t=this,n=new Guacamole.ArrayBufferWriter(e)
n.onack=function(e){t.onack&&t.onack(e)}
var a=function(e,t,n){var a=(e.slice||e.webkitSlice||e.mozSlice).bind(e),r=n-t
if(r!==n){var o=a(t,r)
if(o.size===r)return o}return a(t,n)}
this.sendBlob=function(e){var r=0,o=new FileReader,i=function(){if(r>=e.size)return void(t.oncomplete&&t.oncomplete(e))
var i=a(e,r,r+n.blobLength)
r+=n.blobLength,o.readAsArrayBuffer(i)}
o.onload=function(){n.sendData(o.result),n.onack=function(a){t.onack&&t.onack(a),a.isError()||(t.onprogress&&t.onprogress(e,r-n.blobLength),i())}},o.onerror=function(){t.onerror&&t.onerror(e,r,o.error)},i()},this.sendEnd=function(){n.sendEnd()},this.onack=null,this.onerror=null,this.onprogress=null,this.oncomplete=null},Guacamole.Client=function(e){function t(e){e!=d&&(d=e,r.onstatechange&&r.onstatechange(d))}function n(){return d==s||d==u}function a(t){var n=S[t]
return null==n&&(n=S[t]=new Guacamole.Parser,n.oninstruction=e.oninstruction),n}var r=this,o=0,i=1,u=2,s=3,l=4,c=5,d=o,f=0,h=null,p={0:"butt",1:"round",2:"square"},m={0:"bevel",1:"miter",2:"round"},v=new Guacamole.Display,g={},y={},w={},S=[],b=[],I=[],T=new Guacamole.IntegerPool,G=[]
this.getDisplay=function(){return v},this.sendSize=function(t,a){n()&&e.sendMessage("size",t,a)},this.sendKeyEvent=function(t,a){n()&&e.sendMessage("key",a,t)},this.sendMouseState=function(t){if(n()){v.moveCursor(Math.floor(t.x),Math.floor(t.y))
var a=0
t.left&&(a|=1),t.middle&&(a|=2),t.right&&(a|=4),t.up&&(a|=8),t.down&&(a|=16),e.sendMessage("mouse",Math.floor(t.x),Math.floor(t.y),a)}},this.setClipboard=function(e){if(n()){for(var t=r.createClipboardStream("text/plain"),a=new Guacamole.StringWriter(t),o=0;o<e.length;o+=4096)a.sendText(e.substring(o,o+4096))
a.sendEnd()}},this.createOutputStream=function(){var e=T.next(),t=G[e]=new Guacamole.OutputStream(r,e)
return t},this.createAudioStream=function(t){var n=r.createOutputStream()
return e.sendMessage("audio",n.index,t),n},this.createFileStream=function(t,n){var a=r.createOutputStream()
return e.sendMessage("file",a.index,t,n),a},this.createPipeStream=function(t,n){var a=r.createOutputStream()
return e.sendMessage("pipe",a.index,t,n),a},this.createClipboardStream=function(t){var n=r.createOutputStream()
return e.sendMessage("clipboard",n.index,t),n},this.createObjectOutputStream=function(t,n,a){var o=r.createOutputStream()
return e.sendMessage("put",t,o.index,n,a),o},this.requestObjectInputStream=function(t,a){n()&&e.sendMessage("get",t,a)},this.sendAck=function(t,a,r){n()&&e.sendMessage("ack",t,a,r)},this.sendBlob=function(t,a){n()&&e.sendMessage("blob",t,a)},this.endStream=function(t){n()&&(e.sendMessage("end",t),G[t]&&(T.free(t),delete G[t]))},this.onstatechange=null,this.onname=null,this.onerror=null,this.onaudio=null,this.onvideo=null,this.onclipboard=null,this.onfile=null,this.onfilesystem=null,this.onpipe=null,this.onsync=null
var C=function(e){var t=g[e]
return t||(t=0===e?v.getDefaultLayer():e>0?v.createLayer():v.createBuffer(),g[e]=t),t},k={"miter-limit":function(e,t){v.setMiterLimit(e,parseFloat(t))}},E={ack:function(e){var t=parseInt(e[0]),n=e[1],a=parseInt(e[2]),r=G[t]
r&&(r.onack&&r.onack(new Guacamole.Status(a,n)),a>=256&&G[t]===r&&(T.free(t),delete G[t]))},arc:function(e){var t=C(parseInt(e[0])),n=parseInt(e[1]),a=parseInt(e[2]),r=parseInt(e[3]),o=parseFloat(e[4]),i=parseFloat(e[5]),u=parseInt(e[6])
v.arc(t,n,a,r,o,i,0!=u)},audio:function(e){var t=parseInt(e[0]),n=e[1],a=b[t]=new Guacamole.InputStream(r,t),o=null
r.onaudio&&(o=r.onaudio(a,n)),o||(o=Guacamole.AudioPlayer.getInstance(a,n)),o?(y[t]=o,r.sendAck(t,"OK",0)):r.sendAck(t,"BAD TYPE",783)},blob:function(e){var t=parseInt(e[0]),n=e[1],a=b[t]
a&&a.onblob&&a.onblob(n)},body:function(e){var t=parseInt(e[0]),n=I[t],a=parseInt(e[1]),o=e[2],i=e[3]
if(n&&n.onbody){var u=b[a]=new Guacamole.InputStream(r,a)
n.onbody(u,o,i)}else r.sendAck(a,"Receipt of body unsupported",256)},cfill:function(e){var t=parseInt(e[0]),n=C(parseInt(e[1])),a=parseInt(e[2]),r=parseInt(e[3]),o=parseInt(e[4]),i=parseInt(e[5])
v.setChannelMask(n,t),v.fillColor(n,a,r,o,i)},clip:function(e){var t=C(parseInt(e[0]))
v.clip(t)},clipboard:function(e){var t=parseInt(e[0]),n=e[1]
if(r.onclipboard){var a=b[t]=new Guacamole.InputStream(r,t)
r.onclipboard(a,n)}else r.sendAck(t,"Clipboard unsupported",256)},close:function(e){var t=C(parseInt(e[0]))
v.close(t)},copy:function(e){var t=C(parseInt(e[0])),n=parseInt(e[1]),a=parseInt(e[2]),r=parseInt(e[3]),o=parseInt(e[4]),i=parseInt(e[5]),u=C(parseInt(e[6])),s=parseInt(e[7]),l=parseInt(e[8])
v.setChannelMask(u,i),v.copy(t,n,a,r,o,u,s,l)},cstroke:function(e){var t=parseInt(e[0]),n=C(parseInt(e[1])),a=p[parseInt(e[2])],r=m[parseInt(e[3])],o=parseInt(e[4]),i=parseInt(e[5]),u=parseInt(e[6]),s=parseInt(e[7]),l=parseInt(e[8])
v.setChannelMask(n,t),v.strokeColor(n,a,r,o,i,u,s,l)},cursor:function(e){var t=parseInt(e[0]),n=parseInt(e[1]),a=C(parseInt(e[2])),r=parseInt(e[3]),o=parseInt(e[4]),i=parseInt(e[5]),u=parseInt(e[6])
v.setCursor(t,n,a,r,o,i,u)},curve:function(e){var t=C(parseInt(e[0])),n=parseInt(e[1]),a=parseInt(e[2]),r=parseInt(e[3]),o=parseInt(e[4]),i=parseInt(e[5]),u=parseInt(e[6])
v.curveTo(t,n,a,r,o,i,u)},dispose:function(e){var t=parseInt(e[0])
if(t>0){var n=C(t)
n.dispose(),delete g[t]}else 0>t&&delete g[t]},distort:function(e){var t=parseInt(e[0]),n=parseFloat(e[1]),a=parseFloat(e[2]),r=parseFloat(e[3]),o=parseFloat(e[4]),i=parseFloat(e[5]),u=parseFloat(e[6])
if(t>=0){var s=C(t)
s.distort(n,a,r,o,i,u)}},error:function(e){var t=e[0],n=parseInt(e[1])
r.onerror&&r.onerror(new Guacamole.Status(n,t)),r.disconnect()},end:function(e){var t=parseInt(e[0]),n=b[t]
n&&(n.onend&&n.onend(),delete b[t])},file:function(e){var t=parseInt(e[0]),n=e[1],a=e[2]
if(r.onfile){var o=b[t]=new Guacamole.InputStream(r,t)
r.onfile(o,n,a)}else r.sendAck(t,"File transfer unsupported",256)},filesystem:function(e){var t=parseInt(e[0]),n=e[1]
if(r.onfilesystem){var a=I[t]=new Guacamole.Object(r,t)
r.onfilesystem(a,n)}},identity:function(e){var t=C(parseInt(e[0]))
v.setTransform(t,1,0,0,1,0,0)},img:function(e){var t=parseInt(e[0]),n=parseInt(e[1]),a=C(parseInt(e[2])),o=e[3],i=parseInt(e[4]),u=parseInt(e[5]),s=b[t]=new Guacamole.InputStream(r,t),l=new Guacamole.DataURIReader(s,o)
l.onend=function(){v.setChannelMask(a,n),v.draw(a,i,u,l.getURI())}},jpeg:function(e){var t=parseInt(e[0]),n=C(parseInt(e[1])),a=parseInt(e[2]),r=parseInt(e[3]),o=e[4]
v.setChannelMask(n,t),v.draw(n,a,r,"data:image/jpeg;base64,"+o)},lfill:function(e){var t=parseInt(e[0]),n=C(parseInt(e[1])),a=C(parseInt(e[2]))
v.setChannelMask(n,t),v.fillLayer(n,a)},line:function(e){var t=C(parseInt(e[0])),n=parseInt(e[1]),a=parseInt(e[2])
v.lineTo(t,n,a)},lstroke:function(e){var t=parseInt(e[0]),n=C(parseInt(e[1])),a=C(parseInt(e[2]))
v.setChannelMask(n,t),v.strokeLayer(n,a)},move:function(e){var t=parseInt(e[0]),n=parseInt(e[1]),a=parseInt(e[2]),r=parseInt(e[3]),o=parseInt(e[4])
if(t>0&&n>=0){var i=C(t),u=C(n)
i.move(u,a,r,o)}},name:function(e){r.onname&&r.onname(e[0])},nest:function(e){var t=a(parseInt(e[0]))
t.receive(e[1])},pipe:function(e){var t=parseInt(e[0]),n=e[1],a=e[2]
if(r.onpipe){var o=b[t]=new Guacamole.InputStream(r,t)
r.onpipe(o,n,a)}else r.sendAck(t,"Named pipes unsupported",256)},png:function(e){var t=parseInt(e[0]),n=C(parseInt(e[1])),a=parseInt(e[2]),r=parseInt(e[3]),o=e[4]
v.setChannelMask(n,t),v.draw(n,a,r,"data:image/png;base64,"+o)},pop:function(e){var t=C(parseInt(e[0]))
v.pop(t)},push:function(e){var t=C(parseInt(e[0]))
v.push(t)},rect:function(e){var t=C(parseInt(e[0])),n=parseInt(e[1]),a=parseInt(e[2]),r=parseInt(e[3]),o=parseInt(e[4])
v.rect(t,n,a,r,o)},reset:function(e){var t=C(parseInt(e[0]))
v.reset(t)},set:function(e){var t=C(parseInt(e[0])),n=e[1],a=e[2],r=k[n]
r&&r(t,a)},shade:function(e){var t=parseInt(e[0]),n=parseInt(e[1])
if(t>=0){var a=C(t)
a.shade(n)}},size:function(e){var t=parseInt(e[0]),n=C(t),a=parseInt(e[1]),r=parseInt(e[2])
v.resize(n,a,r)},start:function(e){var t=C(parseInt(e[0])),n=parseInt(e[1]),a=parseInt(e[2])
v.moveTo(t,n,a)},sync:function(n){var a=parseInt(n[0])
v.flush(function(){for(var t in y){var n=y[t]
n&&n.sync()}a!==f&&(e.sendMessage("sync",a),f=a)}),d===u&&t(s),r.onsync&&r.onsync(a)},transfer:function(e){var t=C(parseInt(e[0])),n=parseInt(e[1]),a=parseInt(e[2]),r=parseInt(e[3]),o=parseInt(e[4]),i=parseInt(e[5]),u=C(parseInt(e[6])),s=parseInt(e[7]),l=parseInt(e[8])
3===i?v.put(t,n,a,r,o,u,s,l):5!==i&&v.transfer(t,n,a,r,o,u,s,l,Guacamole.Client.DefaultTransferFunction[i])},transform:function(e){var t=C(parseInt(e[0])),n=parseFloat(e[1]),a=parseFloat(e[2]),r=parseFloat(e[3]),o=parseFloat(e[4]),i=parseFloat(e[5]),u=parseFloat(e[6])
v.transform(t,n,a,r,o,i,u)},undefine:function(e){var t=parseInt(e[0]),n=I[t]
n&&n.onundefine&&n.onundefine()},video:function(e){var t=parseInt(e[0]),n=C(parseInt(e[1])),a=e[2],o=b[t]=new Guacamole.InputStream(r,t),i=null
r.onvideo&&(i=r.onvideo(o,n,a)),i||(i=Guacamole.VideoPlayer.getInstance(o,n,a)),i?(w[t]=i,r.sendAck(t,"OK",0)):r.sendAck(t,"BAD TYPE",783)}}
e.oninstruction=function(e,t){var n=E[e]
n&&n(t)},this.disconnect=function(){d!=c&&d!=l&&(t(l),h&&window.clearInterval(h),e.sendMessage("disconnect"),e.disconnect(),t(c))},this.connect=function(n){t(i)
try{e.connect(n)}catch(a){throw t(o),a}h=window.setInterval(function(){e.sendMessage("sync",f)},5e3),t(u)}},Guacamole.Client.DefaultTransferFunction={0:function(e,t){t.red=t.green=t.blue=0},15:function(e,t){t.red=t.green=t.blue=255},3:function(e,t){t.red=e.red,t.green=e.green,t.blue=e.blue,t.alpha=e.alpha},5:function(e,t){},12:function(e,t){t.red=255&~e.red,t.green=255&~e.green,t.blue=255&~e.blue,t.alpha=e.alpha},10:function(e,t){t.red=255&~t.red,t.green=255&~t.green,t.blue=255&~t.blue},1:function(e,t){t.red=e.red&t.red,t.green=e.green&t.green,t.blue=e.blue&t.blue},14:function(e,t){t.red=255&~(e.red&t.red),t.green=255&~(e.green&t.green),t.blue=255&~(e.blue&t.blue)},7:function(e,t){t.red=e.red|t.red,t.green=e.green|t.green,t.blue=e.blue|t.blue},8:function(e,t){t.red=255&~(e.red|t.red),t.green=255&~(e.green|t.green),t.blue=255&~(e.blue|t.blue)},6:function(e,t){t.red=e.red^t.red,t.green=e.green^t.green,t.blue=e.blue^t.blue},9:function(e,t){t.red=255&~(e.red^t.red),t.green=255&~(e.green^t.green),t.blue=255&~(e.blue^t.blue)},4:function(e,t){t.red=255&(~e.red&t.red),t.green=255&(~e.green&t.green),t.blue=255&(~e.blue&t.blue)},13:function(e,t){t.red=255&(~e.red|t.red),t.green=255&(~e.green|t.green),t.blue=255&(~e.blue|t.blue)},2:function(e,t){t.red=255&(e.red&~t.red),t.green=255&(e.green&~t.green),t.blue=255&(e.blue&~t.blue)},11:function(e,t){t.red=255&(e.red|~t.red),t.green=255&(e.green|~t.green),t.blue=255&(e.blue|~t.blue)}},Guacamole.DataURIReader=function(e,t){var n=this,a="data:"+t+";base64,"
e.onblob=function(e){a+=e},e.onend=function(){n.onend&&n.onend()},this.getURI=function(){return a},this.onend=null},Guacamole.Display=function(){function e(){for(var e=0;e<h.length;){var t=h[e]
if(!t.isReady())break
t.flush(),e++}h.splice(0,e)}function t(e,t){this.isReady=function(){for(var e=0;e<t.length;e++)if(t[e].blocked)return!1
return!0},this.flush=function(){for(var n=0;n<t.length;n++)t[n].execute()
e&&e()}}function n(t,n){var a=this
this.blocked=n,this.unblock=function(){a.blocked&&(a.blocked=!1,e())},this.execute=function(){t&&t()}}function a(e,t){var a=new n(e,t)
return f.push(a),a}var r=this,o=0,i=0,u=1,s=document.createElement("div")
s.style.position="relative",s.style.width=o+"px",s.style.height=i+"px",s.style.transformOrigin=s.style.webkitTransformOrigin=s.style.MozTransformOrigin=s.style.OTransformOrigin=s.style.msTransformOrigin="0 0"
var l=new Guacamole.Display.VisibleLayer(o,i),c=new Guacamole.Display.VisibleLayer(0,0)
c.setChannelMask(Guacamole.Layer.SRC),s.appendChild(l.getElement()),s.appendChild(c.getElement())
var d=document.createElement("div")
d.style.position="relative",d.style.width=o*u+"px",d.style.height=i*u+"px",d.appendChild(s),this.cursorHotspotX=0,this.cursorHotspotY=0,this.cursorX=0,this.cursorY=0,this.onresize=null,this.oncursor=null
var f=[],h=[]
this.getElement=function(){return d},this.getWidth=function(){return o},this.getHeight=function(){return i},this.getDefaultLayer=function(){return l},this.getCursorLayer=function(){return c},this.createLayer=function(){var e=new Guacamole.Display.VisibleLayer(o,i)
return e.move(l,0,0,0),e},this.createBuffer=function(){var e=new Guacamole.Layer(0,0)
return e.autosize=1,e},this.flush=function(n){h.push(new t(n,f)),f=[],e()},this.setCursor=function(e,t,n,o,i,u,s){a(function(){r.cursorHotspotX=e,r.cursorHotspotY=t,c.resize(u,s),c.copy(n,o,i,u,s,0,0),r.moveCursor(r.cursorX,r.cursorY),r.oncursor&&r.oncursor(c.getCanvas(),e,t)})},this.showCursor=function(e){var t=c.getElement(),n=t.parentNode
e===!1?n&&n.removeChild(t):n!==s&&s.appendChild(t)},this.moveCursor=function(e,t){c.translate(e-r.cursorHotspotX,t-r.cursorHotspotY),r.cursorX=e,r.cursorY=t},this.resize=function(e,t,n){a(function(){e.resize(t,n),e===l&&(o=t,i=n,s.style.width=o+"px",s.style.height=i+"px",d.style.width=o*u+"px",d.style.height=i*u+"px",r.onresize&&r.onresize(t,n))})},this.drawImage=function(e,t,n,r){a(function(){e.drawImage(t,n,r)})},this.drawBlob=function(e,t,n,r){var o=URL.createObjectURL(r),i=a(function(){e.drawImage(t,n,u),URL.revokeObjectURL(o)},!0),u=new Image
u.onload=i.unblock,u.src=o},this.draw=function(e,t,n,r){var o=a(function(){e.drawImage(t,n,i)},!0),i=new Image
i.onload=o.unblock,i.src=r},this.play=function(e,t,n,r){var o=document.createElement("video")
o.type=t,o.src=r,o.addEventListener("play",function(){function t(){e.drawImage(0,0,o),o.ended||window.setTimeout(t,20)}t()},!1),a(o.play)},this.transfer=function(e,t,n,r,o,i,u,s,l){a(function(){i.transfer(e,t,n,r,o,u,s,l)})},this.put=function(e,t,n,r,o,i,u,s){a(function(){i.put(e,t,n,r,o,u,s)})},this.copy=function(e,t,n,r,o,i,u,s){a(function(){i.copy(e,t,n,r,o,u,s)})},this.moveTo=function(e,t,n){a(function(){e.moveTo(t,n)})},this.lineTo=function(e,t,n){a(function(){e.lineTo(t,n)})},this.arc=function(e,t,n,r,o,i,u){a(function(){e.arc(t,n,r,o,i,u)})},this.curveTo=function(e,t,n,r,o,i,u){a(function(){e.curveTo(t,n,r,o,i,u)})},this.close=function(e){a(function(){e.close()})},this.rect=function(e,t,n,r,o){a(function(){e.rect(t,n,r,o)})},this.clip=function(e){a(function(){e.clip()})},this.strokeColor=function(e,t,n,r,o,i,u,s){a(function(){e.strokeColor(t,n,r,o,i,u,s)})},this.fillColor=function(e,t,n,r,o){a(function(){e.fillColor(t,n,r,o)})},this.strokeLayer=function(e,t,n,r,o){a(function(){e.strokeLayer(t,n,r,o)})},this.fillLayer=function(e,t){a(function(){e.fillLayer(t)})},this.push=function(e){a(function(){e.push()})},this.pop=function(e){a(function(){e.pop()})},this.reset=function(e){a(function(){e.reset()})},this.setTransform=function(e,t,n,r,o,i,u){a(function(){e.setTransform(t,n,r,o,i,u)})},this.transform=function(e,t,n,r,o,i,u){a(function(){e.transform(t,n,r,o,i,u)})},this.setChannelMask=function(e,t){a(function(){e.setChannelMask(t)})},this.setMiterLimit=function(e,t){a(function(){e.setMiterLimit(t)})},this.scale=function(e){s.style.transform=s.style.WebkitTransform=s.style.MozTransform=s.style.OTransform=s.style.msTransform="scale("+e+","+e+")",u=e,d.style.width=o*u+"px",d.style.height=i*u+"px"},this.getScale=function(){return u},this.flatten=function(){function e(e){var t=[]
for(var n in e.children)t.push(e.children[n])
return t.sort(function(e,t){var n=e.z-t.z
if(0!==n)return n
var a=e.getElement(),r=t.getElement(),o=r.compareDocumentPosition(a)
return o&Node.DOCUMENT_POSITION_PRECEDING?-1:o&Node.DOCUMENT_POSITION_FOLLOWING?1:0}),t}function t(n,r,o){if(n.width>0&&n.height>0){var i=a.globalAlpha
a.globalAlpha*=n.alpha/255,a.drawImage(n.getCanvas(),r,o)
for(var u=e(n),s=0;s<u.length;s++){var l=u[s]
t(l,r+l.x,o+l.y)}a.globalAlpha=i}}var n=document.createElement("canvas")
n.width=l.width,n.height=l.height
var a=n.getContext("2d")
return t(l,0,0),n}},Guacamole.Display.VisibleLayer=function(e,t){Guacamole.Layer.apply(this,[e,t])
var n=this
this.__unique_id=Guacamole.Display.VisibleLayer.__next_id++,this.alpha=255,this.x=0,this.y=0,this.z=0,this.matrix=[1,0,0,1,0,0],this.parent=null,this.children={}
var a=n.getCanvas()
a.style.position="absolute",a.style.left="0px",a.style.top="0px"
var r=document.createElement("div")
r.appendChild(a),r.style.width=e+"px",r.style.height=t+"px",r.style.position="absolute",r.style.left="0px",r.style.top="0px",r.style.overflow="hidden"
var o=this.resize
this.resize=function(e,t){r.style.width=e+"px",r.style.height=t+"px",o(e,t)},this.getElement=function(){return r}
var i="translate(0px, 0px)",u="matrix(1, 0, 0, 1, 0, 0)"
this.translate=function(e,t){n.x=e,n.y=t,i="translate("+e+"px,"+t+"px)",r.style.transform=r.style.WebkitTransform=r.style.MozTransform=r.style.OTransform=r.style.msTransform=i+" "+u},this.move=function(e,t,a,o){if(n.parent!==e){n.parent&&delete n.parent.children[n.__unique_id],n.parent=e,e.children[n.__unique_id]=n
var i=e.getElement()
i.appendChild(r)}n.translate(t,a),n.z=o,r.style.zIndex=o},this.shade=function(e){n.alpha=e,r.style.opacity=e/255},this.dispose=function(){n.parent&&(delete n.parent.children[n.__unique_id],n.parent=null),r.parentNode&&r.parentNode.removeChild(r)},this.distort=function(e,t,a,o,s,l){n.matrix=[e,t,a,o,s,l],u="matrix("+e+","+t+","+a+","+o+","+s+","+l+")",r.style.transform=r.style.WebkitTransform=r.style.MozTransform=r.style.OTransform=r.style.msTransform=i+" "+u}},Guacamole.Display.VisibleLayer.__next_id=0,Guacamole.InputStream=function(e,t){var n=this
this.index=t,this.onblob=null,this.onend=null,this.sendAck=function(t,a){e.sendAck(n.index,t,a)}},Guacamole.IntegerPool=function(){var e=this,t=[]
this.next_int=0,this.next=function(){return t.length>0?t.shift():e.next_int++},this.free=function(e){t.push(e)}},Guacamole.JSONReader=function(e){var t=this,n=new Guacamole.StringReader(e),a=""
this.getLength=function(){return a.length},this.getJSON=function(){return JSON.parse(a)},n.ontext=function(e){a+=e,t.onprogress&&t.onprogress(e.length)},n.onend=function(){t.onend&&t.onend()},this.onprogress=null,this.onend=null},Guacamole.Keyboard=function(e){function t(e,t,n){if(!e)return null
var r,o=e.indexOf("U+")
if(o>=0){var i=e.substring(o+2)
r=String.fromCharCode(parseInt(i,16))}else{if(1!==e.length||3===t)return w(h[e],t)
r=e}n===!0?r=r.toUpperCase():n===!1&&(r=r.toLowerCase())
var u=r.charCodeAt(0)
return a(u)}function n(e){return 31>=e||e>=127&&159>=e}function a(e){return n(e)?65280|e:e>=0&&255>=e?e:e>=256&&1114111>=e?16777216|e:null}function r(e,t){return w(f[e],t)}function o(){var e=G()
if(!e)return!1
var t
do t=e,e=G()
while(null!==e)
return t.defaultPrevented}var i=this
this.onkeydown=null,this.onkeyup=null
var u=function(){var e=this
this.timestamp=(new Date).getTime(),this.defaultPrevented=!1,this.keysym=null,this.reliable=!1,this.getAge=function(){return(new Date).getTime()-e.timestamp}},s=function(e,n,a,o){u.apply(this),this.keyCode=e,this.keyIdentifier=n,this.key=a,this.location=o,this.keysym=t(a,o)||r(e,o),this.keysym&&!S(this.keysym)&&(this.reliable=!0),!this.keysym&&b(e,n)&&(this.keysym=t(n,o,i.modifiers.shift))
var s=!(i.modifiers.ctrl||navigator&&navigator.platform&&navigator.platform.match(/^mac/i)),l=!i.modifiers.alt;(l&&i.modifiers.ctrl||s&&i.modifiers.alt||i.modifiers.meta||i.modifiers.hyper)&&(this.reliable=!0),v[e]=this.keysym}
s.prototype=new u
var l=function(e){u.apply(this),this.charCode=e,this.keysym=a(e),this.reliable=!0}
l.prototype=new u
var c=function(e,n,a,o){u.apply(this),this.keyCode=e,this.keyIdentifier=n,this.key=a,this.location=o,this.keysym=v[e]||r(e,o)||t(a,o),this.reliable=!0}
c.prototype=new u
var d=[],f={8:[65288],9:[65289],12:[65291,65291,65291,65461],13:[65293],16:[65505,65505,65506],17:[65507,65507,65508],18:[65513,65513,65027],19:[65299],20:[65509],27:[65307],32:[32],33:[65365,65365,65365,65465],34:[65366,65366,65366,65459],35:[65367,65367,65367,65457],36:[65360,65360,65360,65463],37:[65361,65361,65361,65460],38:[65362,65362,65362,65464],39:[65363,65363,65363,65462],40:[65364,65364,65364,65458],45:[65379,65379,65379,65456],46:[65535,65535,65535,65454],91:[65515],92:[65383],93:null,96:[65456],97:[65457],98:[65458],99:[65459],100:[65460],101:[65461],102:[65462],103:[65463],104:[65464],105:[65465],106:[65450],107:[65451],109:[65453],110:[65454],111:[65455],112:[65470],113:[65471],114:[65472],115:[65473],116:[65474],117:[65475],118:[65476],119:[65477],120:[65478],121:[65479],122:[65480],123:[65481],144:[65407],145:[65300],225:[65027]},h={Again:[65382],AllCandidates:[65341],Alphanumeric:[65328],Alt:[65513,65513,65027],Attn:[64782],AltGraph:[65027],ArrowDown:[65364],ArrowLeft:[65361],ArrowRight:[65363],ArrowUp:[65362],Backspace:[65288],CapsLock:[65509],Cancel:[65385],Clear:[65291],Convert:[65313],Copy:[64789],Crsel:[64796],CrSel:[64796],CodeInput:[65335],Compose:[65312],Control:[65507,65507,65508],ContextMenu:[65383],DeadGrave:[65104],DeadAcute:[65105],DeadCircumflex:[65106],DeadTilde:[65107],DeadMacron:[65108],DeadBreve:[65109],DeadAboveDot:[65110],DeadUmlaut:[65111],DeadAboveRing:[65112],DeadDoubleacute:[65113],DeadCaron:[65114],DeadCedilla:[65115],DeadOgonek:[65116],DeadIota:[65117],DeadVoicedSound:[65118],DeadSemivoicedSound:[65119],Delete:[65535],Down:[65364],End:[65367],Enter:[65293],EraseEof:[64774],Escape:[65307],Execute:[65378],Exsel:[64797],ExSel:[64797],F1:[65470],F2:[65471],F3:[65472],F4:[65473],F5:[65474],F6:[65475],F7:[65476],F8:[65477],F9:[65478],F10:[65479],F11:[65480],F12:[65481],F13:[65482],F14:[65483],F15:[65484],F16:[65485],F17:[65486],F18:[65487],F19:[65488],F20:[65489],F21:[65490],F22:[65491],F23:[65492],F24:[65493],Find:[65384],GroupFirst:[65036],GroupLast:[65038],GroupNext:[65032],GroupPrevious:[65034],FullWidth:null,HalfWidth:null,HangulMode:[65329],Hankaku:[65321],HanjaMode:[65332],Help:[65386],Hiragana:[65317],HiraganaKatakana:[65319],Home:[65360],Hyper:[65517,65517,65518],Insert:[65379],JapaneseHiragana:[65317],JapaneseKatakana:[65318],JapaneseRomaji:[65316],JunjaMode:[65336],KanaMode:[65325],KanjiMode:[65313],Katakana:[65318],Left:[65361],Meta:[65511,65511,65512],ModeChange:[65406],NumLock:[65407],PageDown:[65366],PageUp:[65365],Pause:[65299],Play:[64790],PreviousCandidate:[65342],PrintScreen:[64797],Redo:[65382],Right:[65363],RomanCharacters:null,Scroll:[65300],Select:[65376],Separator:[65452],Shift:[65505,65505,65506],SingleCandidate:[65340],Super:[65515,65515,65516],Tab:[65289],Up:[65362],Undo:[65381],Win:[65515],Zenkaku:[65320],ZenkakuHankaku:[65322]},p={65027:!0,65505:!0,65506:!0,65507:!0,65508:!0,65511:!0,65512:!0,65513:!0,65514:!0,65515:!0,65516:!0}
this.modifiers=new Guacamole.Keyboard.ModifierState,this.pressed={}
var m={},v={},g=null,y=null,w=function(e,t){return e?e[t]||e[0]:null},S=function(e){return e>=0&&255>=e||16777216===(4294901760&e)},b=function(e,t){if(!t)return!1
var n=t.indexOf("U+")
if(-1===n)return!0
var a=parseInt(t.substring(n+2),16)
return e!==a?!0:e>=65&&90>=e||e>=48&&57>=e}
this.press=function(e){if(null!==e){if(!i.pressed[e]&&(i.pressed[e]=!0,i.onkeydown)){var t=i.onkeydown(e)
return m[e]=t,window.clearTimeout(g),window.clearInterval(y),p[e]||(g=window.setTimeout(function(){y=window.setInterval(function(){i.onkeyup(e),i.onkeydown(e)},50)},500)),t}return m[e]||!1}},this.release=function(e){i.pressed[e]&&(delete i.pressed[e],window.clearTimeout(g),window.clearInterval(y),null!==e&&i.onkeyup&&i.onkeyup(e))},this.reset=function(){for(var e in i.pressed)i.release(parseInt(e))
d=[]}
var I=function(e){var t=Guacamole.Keyboard.ModifierState.fromKeyboardEvent(e)
i.modifiers.alt&&t.alt===!1&&(i.release(65513),i.release(65514),i.release(65027)),i.modifiers.shift&&t.shift===!1&&(i.release(65505),i.release(65506)),i.modifiers.ctrl&&t.ctrl===!1&&(i.release(65507),i.release(65508)),i.modifiers.meta&&t.meta===!1&&(i.release(65511),i.release(65512)),i.modifiers.hyper&&t.hyper===!1&&(i.release(65515),i.release(65516)),i.modifiers=t},T=function(e){i.modifiers.ctrl&&i.modifiers.alt&&(e>=65&&90>=e||e>=97&&122>=e||(255>=e||16777216===(4278190080&e))&&(i.release(65507),i.release(65508),i.release(65513),i.release(65514)))},G=function(){var e=d[0]
if(!e)return null
if(!(e instanceof s)){if(e instanceof c){var t=e.keysym
return t?(i.release(t),e.defaultPrevented=!0,d.shift()):(i.reset(),e)}return d.shift()}var t=null,n=[]
if(e.reliable?(t=e.keysym,n=d.splice(0,1)):d[1]instanceof l?(t=d[1].keysym,n=d.splice(0,2)):d[1]&&(t=e.keysym,n=d.splice(0,1)),n.length>0){if(t){T(t)
var a=!i.press(t)
v[e.keyCode]=t,i.modifiers.meta&&65511!==t&&65512!==t&&i.release(t)
for(var r=0;r<n.length;r++)n[r].defaultPrevented=a}return e}return null},C=function(e){return"location"in e?e.location:"keyLocation"in e?e.keyLocation:0}
e.addEventListener("keydown",function(e){if(i.onkeydown){var t
if(window.event?t=window.event.keyCode:e.which&&(t=e.which),I(e),229!==t){var n=new s(t,e.keyIdentifier,e.key,C(e))
d.push(n),o()&&e.preventDefault()}}},!0),e.addEventListener("keypress",function(e){if(i.onkeydown||i.onkeyup){var t
window.event?t=window.event.keyCode:e.which&&(t=e.which),I(e)
var n=new l(t)
d.push(n),o()&&e.preventDefault()}},!0),e.addEventListener("keyup",function(e){if(i.onkeyup){e.preventDefault()
var t
window.event?t=window.event.keyCode:e.which&&(t=e.which),I(e)
var n=new c(t,e.keyIdentifier,e.key,C(e))
d.push(n),o()}},!0)},Guacamole.Keyboard.ModifierState=function(){this.shift=!1,this.ctrl=!1,this.alt=!1,this.meta=!1,this.hyper=!1},Guacamole.Keyboard.ModifierState.fromKeyboardEvent=function(e){var t=new Guacamole.Keyboard.ModifierState
return t.shift=e.shiftKey,t.ctrl=e.ctrlKey,t.alt=e.altKey,t.meta=e.metaKey,e.getModifierState&&(t.hyper=e.getModifierState("OS")||e.getModifierState("Super")||e.getModifierState("Hyper")||e.getModifierState("Win")),t},Guacamole.Layer=function(e,t){function n(e,t){var n=null
if(0!==r.width&&0!==r.height){n=document.createElement("canvas"),n.width=r.width,n.height=r.height
var a=n.getContext("2d")
a.drawImage(o,0,0,r.width,r.height,0,0,r.width,r.height)}var u=i.globalCompositeOperation
o.width=e,o.height=t,n&&i.drawImage(n,0,0,r.width,r.height,0,0,r.width,r.height),i.globalCompositeOperation=u,r.width=e,r.height=t,s=0,i.save()}function a(e,t,n,a){var o,i=n+e,u=a+t
o=i>r.width?i:r.width
var s
s=u>r.height?u:r.height,r.resize(o,s)}var r=this,o=document.createElement("canvas"),i=o.getContext("2d")
i.save()
var u=!0,s=0,l={1:"destination-in",2:"destination-out",4:"source-in",6:"source-atop",8:"source-out",9:"destination-atop",10:"xor",11:"destination-over",12:"copy",14:"source-over",15:"lighter"}
this.autosize=!1,this.width=e,this.height=t,this.getCanvas=function(){return o},this.resize=function(e,t){e===r.width&&t===r.height||n(e,t)},this.drawImage=function(e,t,n){r.autosize&&a(e,t,n.width,n.height),i.drawImage(n,e,t)},this.transfer=function(e,t,n,o,u,s,l,c){var d=e.getCanvas()
if(!(t>=d.width||n>=d.height)&&(t+o>d.width&&(o=d.width-t),n+u>d.height&&(u=d.height-n),0!==o&&0!==u)){r.autosize&&a(s,l,o,u)
for(var f=e.getCanvas().getContext("2d").getImageData(t,n,o,u),h=i.getImageData(s,l,o,u),p=0;o*u*4>p;p+=4){var m=new Guacamole.Layer.Pixel(f.data[p],f.data[p+1],f.data[p+2],f.data[p+3]),v=new Guacamole.Layer.Pixel(h.data[p],h.data[p+1],h.data[p+2],h.data[p+3])
c(m,v),h.data[p]=v.red,h.data[p+1]=v.green,h.data[p+2]=v.blue,h.data[p+3]=v.alpha}i.putImageData(h,s,l)}},this.put=function(e,t,n,o,u,s,l){var c=e.getCanvas()
if(!(t>=c.width||n>=c.height)&&(t+o>c.width&&(o=c.width-t),n+u>c.height&&(u=c.height-n),0!==o&&0!==u)){r.autosize&&a(s,l,o,u)
var d=e.getCanvas().getContext("2d").getImageData(t,n,o,u)
i.putImageData(d,s,l)}},this.copy=function(e,t,n,o,u,s,l){var c=e.getCanvas()
t>=c.width||n>=c.height||(t+o>c.width&&(o=c.width-t),n+u>c.height&&(u=c.height-n),0!==o&&0!==u&&(r.autosize&&a(s,l,o,u),i.drawImage(c,t,n,o,u,s,l,o,u)))},this.moveTo=function(e,t){u&&(i.beginPath(),u=!1),r.autosize&&a(e,t,0,0),i.moveTo(e,t)},this.lineTo=function(e,t){u&&(i.beginPath(),u=!1),r.autosize&&a(e,t,0,0),i.lineTo(e,t)},this.arc=function(e,t,n,o,s,l){u&&(i.beginPath(),u=!1),r.autosize&&a(e,t,0,0),i.arc(e,t,n,o,s,l)},this.curveTo=function(e,t,n,o,s,l){u&&(i.beginPath(),u=!1),r.autosize&&a(s,l,0,0),i.bezierCurveTo(e,t,n,o,s,l)},this.close=function(){i.closePath(),u=!0},this.rect=function(e,t,n,o){u&&(i.beginPath(),u=!1),r.autosize&&a(e,t,n,o),i.rect(e,t,n,o)},this.clip=function(){i.clip(),u=!0},this.strokeColor=function(e,t,n,a,r,o,s){i.lineCap=e,i.lineJoin=t,i.lineWidth=n,i.strokeStyle="rgba("+a+","+r+","+o+","+s/255+")",i.stroke(),u=!0},this.fillColor=function(e,t,n,a){i.fillStyle="rgba("+e+","+t+","+n+","+a/255+")",i.fill(),u=!0},this.strokeLayer=function(e,t,n,a){i.lineCap=e,i.lineJoin=t,i.lineWidth=n,i.strokeStyle=i.createPattern(a.getCanvas(),"repeat"),i.stroke(),u=!0},this.fillLayer=function(e){i.fillStyle=i.createPattern(e.getCanvas(),"repeat"),i.fill(),u=!0},this.push=function(){i.save(),s++},this.pop=function(){s>0&&(i.restore(),s--)},this.reset=function(){for(;s>0;)i.restore(),s--
i.restore(),i.save(),i.beginPath(),u=!1},this.setTransform=function(e,t,n,a,r,o){i.setTransform(e,t,n,a,r,o)},this.transform=function(e,t,n,a,r,o){i.transform(e,t,n,a,r,o)},this.setChannelMask=function(e){i.globalCompositeOperation=l[e]},this.setMiterLimit=function(e){i.miterLimit=e},o.width=e,o.height=t,o.style.zIndex=-1},Guacamole.Layer.ROUT=2,Guacamole.Layer.ATOP=6,Guacamole.Layer.XOR=10,Guacamole.Layer.ROVER=11,Guacamole.Layer.OVER=14,Guacamole.Layer.PLUS=15,Guacamole.Layer.RIN=1,Guacamole.Layer.IN=4,Guacamole.Layer.OUT=8,Guacamole.Layer.RATOP=9,Guacamole.Layer.SRC=12,Guacamole.Layer.Pixel=function(e,t,n,a){this.red=e,this.green=t,this.blue=n,this.alpha=a},Guacamole.Mouse=function(e){function t(e){e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.returnValue=!1}function n(){o=r.touchMouseThreshold}function a(e){var n=e.deltaY||-e.wheelDeltaY||-e.wheelDelta
if(n?1===e.deltaMode?n=e.deltaY*r.PIXELS_PER_LINE:2===e.deltaMode&&(n=e.deltaY*r.PIXELS_PER_PAGE):n=e.detail*r.PIXELS_PER_LINE,i+=n,i<=-r.scrollThreshold){do r.onmousedown&&(r.currentState.up=!0,r.onmousedown(r.currentState)),r.onmouseup&&(r.currentState.up=!1,r.onmouseup(r.currentState)),i+=r.scrollThreshold
while(i<=-r.scrollThreshold)
i=0}if(i>=r.scrollThreshold){do r.onmousedown&&(r.currentState.down=!0,r.onmousedown(r.currentState)),r.onmouseup&&(r.currentState.down=!1,r.onmouseup(r.currentState)),i-=r.scrollThreshold
while(i>=r.scrollThreshold)
i=0}t(e)}var r=this
this.touchMouseThreshold=3,this.scrollThreshold=53,this.PIXELS_PER_LINE=18,this.PIXELS_PER_PAGE=16*this.PIXELS_PER_LINE,this.currentState=new Guacamole.Mouse.State(0,0,!1,!1,!1,!1,!1),this.onmousedown=null,this.onmouseup=null,this.onmousemove=null,this.onmouseout=null
var o=0,i=0
e.addEventListener("contextmenu",function(e){t(e)},!1),e.addEventListener("mousemove",function(n){return t(n),o?void o--:(r.currentState.fromClientPosition(e,n.clientX,n.clientY),void(r.onmousemove&&r.onmousemove(r.currentState)))},!1),e.addEventListener("mousedown",function(e){if(t(e),!o){switch(e.button){case 0:r.currentState.left=!0
break
case 1:r.currentState.middle=!0
break
case 2:r.currentState.right=!0}r.onmousedown&&r.onmousedown(r.currentState)}},!1),e.addEventListener("mouseup",function(e){if(t(e),!o){switch(e.button){case 0:r.currentState.left=!1
break
case 1:r.currentState.middle=!1
break
case 2:r.currentState.right=!1}r.onmouseup&&r.onmouseup(r.currentState)}},!1),e.addEventListener("mouseout",function(n){n||(n=window.event)
for(var a=n.relatedTarget||n.toElement;a;){if(a===e)return
a=a.parentNode}t(n),(r.currentState.left||r.currentState.middle||r.currentState.right)&&(r.currentState.left=!1,r.currentState.middle=!1,r.currentState.right=!1,r.onmouseup&&r.onmouseup(r.currentState)),r.onmouseout&&r.onmouseout()},!1),e.addEventListener("selectstart",function(e){t(e)},!1),e.addEventListener("touchmove",n,!1),e.addEventListener("touchstart",n,!1),e.addEventListener("touchend",n,!1),e.addEventListener("DOMMouseScroll",a,!1),e.addEventListener("mousewheel",a,!1),e.addEventListener("wheel",a,!1)
var u=function(){var e=document.createElement("div")
if(!("cursor"in e.style))return!1
try{e.style.cursor="url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAAA1BMVEX///+nxBvIAAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==) 0 0, auto"}catch(t){return!1}return/\burl\([^()]*\)\s+0\s+0\b/.test(e.style.cursor||"")}()
this.setCursor=function(t,n,a){if(u){var r=t.toDataURL("image/png")
return e.style.cursor="url("+r+") "+n+" "+a+", auto",!0}return!1}},Guacamole.Mouse.State=function(e,t,n,a,r,o,i){var u=this
this.x=e,this.y=t,this.left=n,this.middle=a,this.right=r,this.up=o,this.down=i,this.fromClientPosition=function(e,t,n){u.x=t-e.offsetLeft,u.y=n-e.offsetTop
for(var a=e.offsetParent;a&&a!==document.body;)u.x-=a.offsetLeft-a.scrollLeft,u.y-=a.offsetTop-a.scrollTop,a=a.offsetParent
if(a){var r=document.body.scrollLeft||document.documentElement.scrollLeft,o=document.body.scrollTop||document.documentElement.scrollTop
u.x-=a.offsetLeft-r,u.y-=a.offsetTop-o}}},Guacamole.Mouse.Touchpad=function(e){var t=this
this.scrollThreshold=20*(window.devicePixelRatio||1),this.clickTimingThreshold=250,this.clickMoveThreshold=10*(window.devicePixelRatio||1),this.currentState=new Guacamole.Mouse.State(0,0,!1,!1,!1,!1,!1),this.onmousedown=null,this.onmouseup=null,this.onmousemove=null
var n=0,a=0,r=0,o=0,i=0,u={1:"left",2:"right",3:"middle"},s=!1,l=null
e.addEventListener("touchend",function(e){if(e.preventDefault(),s&&0===e.touches.length){var a=(new Date).getTime(),r=u[n]
t.currentState[r]&&(t.currentState[r]=!1,t.onmouseup&&t.onmouseup(t.currentState),l&&(window.clearTimeout(l),l=null)),a-o<=t.clickTimingThreshold&&i<t.clickMoveThreshold&&(t.currentState[r]=!0,t.onmousedown&&t.onmousedown(t.currentState),l=window.setTimeout(function(){t.currentState[r]=!1,t.onmouseup&&t.onmouseup(t.currentState),s=!1},t.clickTimingThreshold)),l||(s=!1)}},!1),e.addEventListener("touchstart",function(e){if(e.preventDefault(),n=Math.min(e.touches.length,3),l&&(window.clearTimeout(l),l=null),!s){s=!0
var t=e.touches[0]
a=t.clientX,r=t.clientY,o=(new Date).getTime(),i=0}},!1),e.addEventListener("touchmove",function(u){u.preventDefault()
var s=u.touches[0],l=s.clientX-a,c=s.clientY-r
if(i+=Math.abs(l)+Math.abs(c),1===n){var d=i/((new Date).getTime()-o),f=1+d
t.currentState.x+=l*f,t.currentState.y+=c*f,t.currentState.x<0?t.currentState.x=0:t.currentState.x>=e.offsetWidth&&(t.currentState.x=e.offsetWidth-1),t.currentState.y<0?t.currentState.y=0:t.currentState.y>=e.offsetHeight&&(t.currentState.y=e.offsetHeight-1),t.onmousemove&&t.onmousemove(t.currentState),a=s.clientX,r=s.clientY}else if(2===n&&Math.abs(c)>=t.scrollThreshold){var h
h=c>0?"down":"up",t.currentState[h]=!0,t.onmousedown&&t.onmousedown(t.currentState),t.currentState[h]=!1,t.onmouseup&&t.onmouseup(t.currentState),a=s.clientX,r=s.clientY}},!1)},Guacamole.Mouse.Touchscreen=function(e){function t(e){s.currentState[e]||(s.currentState[e]=!0,s.onmousedown&&s.onmousedown(s.currentState))}function n(e){s.currentState[e]&&(s.currentState[e]=!1,s.onmouseup&&s.onmouseup(s.currentState))}function a(e){t(e),n(e)}function r(t,n){s.currentState.fromClientPosition(e,t,n),s.onmousemove&&s.onmousemove(s.currentState)}function o(e){var t=e.touches[0]||e.changedTouches[0],n=t.clientX-c,a=t.clientY-d
return Math.sqrt(n*n+a*a)>=s.clickMoveThreshold}function i(e){var t=e.touches[0]
l=!0,c=t.clientX,d=t.clientY}function u(){window.clearTimeout(f),window.clearTimeout(h),l=!1}var s=this,l=!1,c=null,d=null,f=null,h=null
this.scrollThreshold=20*(window.devicePixelRatio||1),this.clickTimingThreshold=250,this.clickMoveThreshold=16*(window.devicePixelRatio||1),this.longPressThreshold=500,this.currentState=new Guacamole.Mouse.State(0,0,!1,!1,!1,!1,!1),this.onmousedown=null,this.onmouseup=null,this.onmousemove=null,e.addEventListener("touchend",function(e){if(l){if(0!==e.touches.length||1!==e.changedTouches.length)return void u()
if(window.clearTimeout(h),n("left"),!o(e)&&(e.preventDefault(),!s.currentState.left)){var a=e.changedTouches[0]
r(a.clientX,a.clientY),t("left"),f=window.setTimeout(function(){n("left"),u()},s.clickTimingThreshold)}}},!1),e.addEventListener("touchstart",function(e){return 1!==e.touches.length?void u():(e.preventDefault(),i(e),window.clearTimeout(f),void(h=window.setTimeout(function(){var t=e.touches[0]
r(t.clientX,t.clientY),a("right"),u()},s.longPressThreshold)))},!1),e.addEventListener("touchmove",function(e){if(l){if(o(e)&&window.clearTimeout(h),1!==e.touches.length)return void u()
if(s.currentState.left){e.preventDefault()
var t=e.touches[0]
r(t.clientX,t.clientY)}}},!1)},Guacamole.Object=function(e,t){var n=this,a={},r=function(e){var t=a[e]
if(!t)return null
var n=t.shift()
return 0===t.length&&delete a[e],n},o=function(e,t){var n=a[e]
n||(n=[],a[e]=n),n.push(t)}
this.index=t,this.onbody=function(e,t,n){var a=r(n)
a&&a(e,t)},this.onundefine=null,this.requestInputStream=function(t,a){a&&o(t,a),e.requestObjectInputStream(n.index,t)},this.createOutputStream=function(t,a){return e.createObjectOutputStream(n.index,t,a)}},Guacamole.Object.ROOT_STREAM="/",Guacamole.Object.STREAM_INDEX_MIMETYPE="application/vnd.glyptodon.guacamole.stream-index+json",Guacamole.OnScreenKeyboard=function(e){var t=this,n={},a={},r=[],o=function(e,t){e.classList?e.classList.add(t):e.className+=" "+t},i=function(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(/([^ ]+)[ ]*/g,function(e,n){return n===t?"":e})},u=0,s=function(e,t,n,a){this.width=t,this.height=n,this.scale=function(r){e.style.width=t*r+"px",e.style.height=n*r+"px",a&&(e.style.lineHeight=n*r+"px",e.style.fontSize=r+"px")}},l=function(e){for(var t=0;t<e.length;t++){var a=e[t]
if(!(a in n))return!1}return!0},c=function(e){var n=t.keys[e]
if(!n)return null
for(var a=n.length-1;a>=0;a--){var r=n[a]
if(l(r.requires))return r}return null},d=function(e,r){if(!a[e]){o(r,"guac-keyboard-pressed")
var u=c(e)
if(u.modifier){var s="guac-keyboard-modifier-"+v(u.modifier),l=n[u.modifier]
l?(i(h,s),delete n[u.modifier],t.onkeyup&&t.onkeyup(l)):(o(h,s),n[u.modifier]=u.keysym,t.onkeydown&&t.onkeydown(u.keysym))}else t.onkeydown&&t.onkeydown(u.keysym)
a[e]=!0}},f=function(e,n){if(a[e]){i(n,"guac-keyboard-pressed")
var r=c(e)
!r.modifier&&t.onkeyup&&t.onkeyup(r.keysym),a[e]=!1}},h=document.createElement("div")
h.className="guac-keyboard",h.onselectstart=h.onmousemove=h.onmouseup=h.onmousedown=function(e){return u&&u--,e.stopPropagation(),!1},this.touchMouseThreshold=3,this.onkeydown=null,this.onkeyup=null,this.layout=new Guacamole.OnScreenKeyboard.Layout(e),this.getElement=function(){return h},this.resize=function(e){for(var n=Math.floor(10*e/t.layout.width)/10,a=0;a<r.length;a++){var o=r[a]
o.scale(n)}}
var p=function(e,t){if(t instanceof Array){for(var n=[],a=0;a<t.length;a++)n.push(new Guacamole.OnScreenKeyboard.Key(t[a],e))
return n}return"number"==typeof t?[new Guacamole.OnScreenKeyboard.Key({name:e,keysym:t})]:"string"==typeof t?[new Guacamole.OnScreenKeyboard.Key({name:e,title:t})]:[new Guacamole.OnScreenKeyboard.Key(t,e)]},m=function(t){var n={}
for(var a in e.keys)n[a]=p(a,t[a])
return n}
this.keys=m(e.keys)
var v=function(e){var t=e.replace(/([a-z])([A-Z])/g,"$1-$2").replace(/[^A-Za-z0-9]+/g,"-").toLowerCase()
return t},g=function y(e,n,a){var i,l=document.createElement("div")
if(a&&o(l,"guac-keyboard-"+v(a)),n instanceof Array)for(o(l,"guac-keyboard-group"),i=0;i<n.length;i++)y(l,n[i])
else if(n instanceof Object){o(l,"guac-keyboard-group")
var c=Object.keys(n).sort()
for(i=0;i<c.length;i++){var a=c[i]
y(l,n[a],a)}}else if("number"==typeof n)o(l,"guac-keyboard-gap"),r.push(new s(l,n,n))
else if("string"==typeof n){var h=n
1===h.length&&(h="0x"+h.charCodeAt(0).toString(16)),o(l,"guac-keyboard-key-container")
var p=document.createElement("div")
p.className="guac-keyboard-key guac-keyboard-key-"+v(h)
var m=t.keys[n]
if(m)for(i=0;i<m.length;i++){var g=m[i],w=document.createElement("div")
w.className="guac-keyboard-cap",w.textContent=g.title
for(var S=0;S<g.requires.length;S++){var b=g.requires[S]
o(w,"guac-keyboard-requires-"+v(b)),o(p,"guac-keyboard-uses-"+v(b))}p.appendChild(w)}l.appendChild(p),r.push(new s(l,t.layout.keyWidths[n]||1,1,!0))
var I=function(e){e.preventDefault(),u=t.touchMouseThreshold,d(n,p)},T=function(e){e.preventDefault(),u=t.touchMouseThreshold,f(n,p)},G=function(e){e.preventDefault(),0===u&&d(n,p)},C=function(e){e.preventDefault(),0===u&&f(n,p)}
p.addEventListener("touchstart",I,!0),p.addEventListener("touchend",T,!0),p.addEventListener("mousedown",G,!0),p.addEventListener("mouseup",C,!0),p.addEventListener("mouseout",C,!0)}e.appendChild(l)}
g(h,e.layout)},Guacamole.OnScreenKeyboard.Layout=function(e){this.language=e.language,this.type=e.type,this.keys=e.keys,this.layout=e.layout,this.width=e.width,this.keyWidths=e.keyWidths||{}},Guacamole.OnScreenKeyboard.Key=function(e,t){this.name=t||e.name,this.title=e.title||this.name,this.keysym=e.keysym||function(e){if(!e||1!==e.length)return null
var t=e.charCodeAt(0)
return t>=0&&255>=t?t:t>=256&&1114111>=t?16777216|t:null}(this.title),this.modifier=e.modifier,this.requires=e.requires||[]},Guacamole.OutputStream=function(e,t){var n=this
this.index=t,this.onack=null,this.sendBlob=function(t){e.sendBlob(n.index,t)},this.sendEnd=function(){e.endStream(n.index)}},Guacamole.Parser=function(){var e=this,t="",n=[],a=-1,r=0
this.receive=function(o){for(r>4096&&a>=r&&(t=t.substring(r),a-=r,r=0),t+=o;a<t.length;){if(a>=r){var i=t.substring(r,a),u=t.substring(a,a+1)
if(n.push(i),";"==u){var s=n.shift()
null!=e.oninstruction&&e.oninstruction(s,n),n.length=0}else if(","!=u)throw new Error("Illegal terminator.")
r=a+1}var l=t.indexOf(".",r)
if(-1==l){r=t.length
break}var c=parseInt(t.substring(a+1,l))
if(NaN==c)throw new Error("Non-numeric character in element length.")
r=l+1,a=r+c}},this.oninstruction=null},Guacamole.RawAudioFormat=function(e){this.bytesPerSample=e.bytesPerSample,this.channels=e.channels,this.rate=e.rate},Guacamole.RawAudioFormat.parse=function(e){var t,n=null,a=1
if("audio/L8;"===e.substring(0,9))e=e.substring(9),t=1
else{if("audio/L16;"!==e.substring(0,10))return null
e=e.substring(10),t=2}for(var r=e.split(","),o=0;o<r.length;o++){var i=r[o],u=i.indexOf("=")
if(-1===u)return null
var s=i.substring(0,u),l=i.substring(u+1)
switch(s){case"channels":a=parseInt(l)
break
case"rate":n=parseInt(l)
break
default:return null}}return null===n?null:new Guacamole.RawAudioFormat({bytesPerSample:t,channels:a,rate:n})},Guacamole.Status=function(e,t){var n=this
this.code=e,this.message=t,this.isError=function(){return n.code<0||n.code>255}},Guacamole.Status.Code={SUCCESS:0,UNSUPPORTED:256,SERVER_ERROR:512,SERVER_BUSY:513,UPSTREAM_TIMEOUT:514,UPSTREAM_ERROR:515,RESOURCE_NOT_FOUND:516,RESOURCE_CONFLICT:517,RESOURCE_CLOSED:518,CLIENT_BAD_REQUEST:768,CLIENT_UNAUTHORIZED:769,CLIENT_FORBIDDEN:771,CLIENT_TIMEOUT:776,CLIENT_OVERRUN:781,CLIENT_BAD_TYPE:783,CLIENT_TOO_MANY:797},Guacamole.StringReader=function(e){function t(e){for(var t="",n=new Uint8Array(e),a=0;a<n.length;a++){var i=n[a]
0===r?127===(127|i)?t+=String.fromCharCode(i):223===(31|i)?(o=31&i,r=1):239===(15|i)?(o=15&i,r=2):247===(7|i)?(o=7&i,r=3):t+="�":191===(63|i)?(o=o<<6|63&i,r--,0===r&&(t+=String.fromCharCode(o))):(r=0,t+="�")}return t}var n=this,a=new Guacamole.ArrayBufferReader(e),r=0,o=0
a.ondata=function(e){var a=t(e)
n.ontext&&n.ontext(a)},a.onend=function(){n.onend&&n.onend()},this.ontext=null,this.onend=null},Guacamole.StringWriter=function(e){function t(e){if(u+e>=i.length){var t=new Uint8Array(2*(u+e))
t.set(i),i=t}u+=e}function n(e){var a,r
if(127>=e)a=0,r=1
else if(2047>=e)a=192,r=2
else if(65535>=e)a=224,r=3
else{if(!(2097151>=e))return void n(65533)
a=240,r=4}t(r)
for(var o=u-1,s=1;r>s;s++)i[o--]=128|63&e,e>>=6
i[o]=a|e}function a(e){for(var t=0;t<e.length;t++){var a=e.charCodeAt(t)
n(a)}if(u>0){var r=i.subarray(0,u)
return u=0,r}}var r=this,o=new Guacamole.ArrayBufferWriter(e),i=new Uint8Array(8192),u=0
o.onack=function(e){r.onack&&r.onack(e)},this.sendText=function(e){e.length&&o.sendData(a(e))},this.sendEnd=function(){o.sendEnd()},this.onack=null},Guacamole.Tunnel=function(){this.connect=function(e){},this.disconnect=function(){},this.sendMessage=function(e){},this.state=Guacamole.Tunnel.State.CONNECTING,this.receiveTimeout=15e3,this.uuid=null,this.onerror=null,this.onstatechange=null,this.oninstruction=null},Guacamole.Tunnel.INTERNAL_DATA_OPCODE="",Guacamole.Tunnel.State={CONNECTING:0,OPEN:1,CLOSED:2},Guacamole.HTTPTunnel=function(e,t){function n(){window.clearTimeout(y),y=window.setTimeout(function(){a(new Guacamole.Status(Guacamole.Status.Code.UPSTREAM_TIMEOUT,"Server timeout."))},s.receiveTimeout)}function a(e){s.state!==Guacamole.Tunnel.State.CLOSED&&(e.code!==Guacamole.Status.Code.SUCCESS&&s.onerror&&(s.state!==Guacamole.Tunnel.State.CONNECTING&&e.code===Guacamole.Status.Code.RESOURCE_NOT_FOUND||s.onerror(e)),s.state=Guacamole.Tunnel.State.CLOSED,m=!1,s.onstatechange&&s.onstatechange(s.state))}function r(){if(s.state===Guacamole.Tunnel.State.OPEN)if(v.length>0){m=!0
var e=new XMLHttpRequest
e.open("POST",d+s.uuid),e.withCredentials=g,e.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8"),e.onreadystatechange=function(){4===e.readyState&&(200!==e.status?o(e):r())},e.send(v),v=""}else m=!1}function o(e){var t=parseInt(e.getResponseHeader("Guacamole-Status-Code")),n=e.getResponseHeader("Guacamole-Error-Message")
a(new Guacamole.Status(t,n))}function i(e){function t(){if(s.state!==Guacamole.Tunnel.State.OPEN)return void(null!==a&&clearInterval(a))
if(!(e.readyState<2)){var l
try{l=e.status}catch(h){l=200}if(r||200!==l||(r=u()),3===e.readyState||4===e.readyState){if(n(),p===f&&(3!==e.readyState||a?4!==e.readyState||a||clearInterval(a):a=setInterval(t,30)),0===e.status)return void s.disconnect()
if(200!==e.status)return void o(e)
var v
try{v=e.responseText}catch(h){return}for(;c<v.length;){if(c>=d){var g=v.substring(d,c),y=v.substring(c,c+1)
if(m.push(g),";"===y){var w=m.shift()
s.oninstruction&&s.oninstruction(w,m),m.length=0}d=c+1}var S=v.indexOf(".",d)
if(-1===S){d=v.length
break}var b=parseInt(v.substring(c+1,S))
if(0===b){a||clearInterval(a),e.onreadystatechange=null,e.abort(),r&&i(r)
break}d=S+1,c=d+b}}}}var a=null,r=null,l=0,c=-1,d=0,m=new Array
p===f?e.onreadystatechange=function(){3===e.readyState&&(l++,l>=2&&(p=h,e.onreadystatechange=t)),t()}:e.onreadystatechange=t,t()}function u(){var e=new XMLHttpRequest
return e.open("GET",c+s.uuid+":"+w++),e.withCredentials=g,e.send(null),e}var s=this,l=e+"?connect",c=e+"?read:",d=e+"?write:",f=1,h=0,p=f,m=!1,v="",g=!!t,y=null
this.sendMessage=function(){function e(e){var t=new String(e)
return t.length+"."+t}if(s.state===Guacamole.Tunnel.State.OPEN&&0!==arguments.length){for(var t=e(arguments[0]),n=1;n<arguments.length;n++)t+=","+e(arguments[n])
t+=";",v+=t,m||r()}}
var w=0
this.connect=function(e){n()
var t=new XMLHttpRequest
t.onreadystatechange=function(){if(4===t.readyState){if(200!==t.status)return void o(t)
n(),s.uuid=t.responseText,s.state=Guacamole.Tunnel.State.OPEN,s.onstatechange&&s.onstatechange(s.state),i(u())}},t.open("POST",l,!0),t.withCredentials=g,t.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8"),t.send(e)},this.disconnect=function(){a(new Guacamole.Status(Guacamole.Status.Code.SUCCESS,"Manually closed."))}},Guacamole.HTTPTunnel.prototype=new Guacamole.Tunnel,Guacamole.WebSocketTunnel=function(e){function t(){window.clearTimeout(o),o=window.setTimeout(function(){n(new Guacamole.Status(Guacamole.Status.Code.UPSTREAM_TIMEOUT,"Server timeout."))},a.receiveTimeout)}function n(e){a.state!==Guacamole.Tunnel.State.CLOSED&&(e.code!==Guacamole.Status.Code.SUCCESS&&a.onerror&&a.onerror(e),a.state=Guacamole.Tunnel.State.CLOSED,a.onstatechange&&a.onstatechange(a.state),r.close())}var a=this,r=null,o=null,i={"http:":"ws:","https:":"wss:"}
if("ws:"!==e.substring(0,3)&&"wss:"!==e.substring(0,4)){var u=i[window.location.protocol]
if("/"===e.substring(0,1))e=u+"//"+window.location.host+e
else{var s=window.location.pathname.lastIndexOf("/"),l=window.location.pathname.substring(0,s+1)
e=u+"//"+window.location.host+l+e}}this.sendMessage=function(e){function t(e){var t=new String(e)
return t.length+"."+t}if(a.state===Guacamole.Tunnel.State.OPEN&&0!==arguments.length){for(var n=t(arguments[0]),o=1;o<arguments.length;o++)n+=","+t(arguments[o])
n+=";",r.send(n)}},this.connect=function(o){t(),r=new WebSocket(e+"?"+o,"guacamole"),r.onopen=function(e){t()},r.onclose=function(e){n(new Guacamole.Status(parseInt(e.reason),e.reason))},r.onerror=function(e){n(new Guacamole.Status(Guacamole.Status.Code.SERVER_ERROR,e.data))},r.onmessage=function(e){t()
var r,o=e.data,i=0,u=[]
do{var s=o.indexOf(".",i)
if(-1!==s){var l=parseInt(o.substring(r+1,s))
i=s+1,r=i+l}else n(new Guacamole.Status(Guacamole.Status.Code.SERVER_ERROR,"Incomplete instruction."))
var c=o.substring(i,r),d=o.substring(r,r+1)
if(u.push(c),";"===d){var f=u.shift()
a.state!==Guacamole.Tunnel.State.OPEN&&(f===Guacamole.Tunnel.INTERNAL_DATA_OPCODE&&(a.uuid=u[0]),a.state=Guacamole.Tunnel.State.OPEN,a.onstatechange&&a.onstatechange(a.state)),f!==Guacamole.Tunnel.INTERNAL_DATA_OPCODE&&a.oninstruction&&a.oninstruction(f,u),u.length=0}i=r+1}while(i<o.length)}},this.disconnect=function(){n(new Guacamole.Status(Guacamole.Status.Code.SUCCESS,"Manually closed."))}},Guacamole.WebSocketTunnel.prototype=new Guacamole.Tunnel,Guacamole.ChainedTunnel=function(e){function t(e){function i(){e.onstatechange=a.onstatechange,e.oninstruction=a.oninstruction,e.onerror=a.onerror,a.uuid=e.uuid,o=e}a.disconnect=e.disconnect,a.sendMessage=e.sendMessage
var u=function(n){if(n&&n.code===Guacamole.Status.Code.UPSTREAM_TIMEOUT)return r=[],null
var a=r.shift()
return a&&(e.onerror=null,e.oninstruction=null,e.onstatechange=null,t(a)),a}
e.onstatechange=function(e){switch(e){case Guacamole.Tunnel.State.OPEN:i(),a.onstatechange&&a.onstatechange(e)
break
case Guacamole.Tunnel.State.CLOSED:!u()&&a.onstatechange&&a.onstatechange(e)}},e.oninstruction=function(e,t){i(),a.oninstruction&&a.oninstruction(e,t)},e.onerror=function(e){!u(e)&&a.onerror&&a.onerror(e)},e.connect(n)}for(var n,a=this,r=[],o=null,i=0;i<arguments.length;i++)r.push(arguments[i])
this.connect=function(e){n=e
var i=o?o:r.shift()
i?t(i):a.onerror&&a.onerror(Guacamole.Status.Code.SERVER_ERROR,"No tunnels to try.")}},Guacamole.ChainedTunnel.prototype=new Guacamole.Tunnel,Guacamole.API_VERSION="0.9.9",Guacamole.VideoPlayer=function(){this.sync=function(){}},Guacamole.VideoPlayer.isSupportedType=function(e){return!1},Guacamole.VideoPlayer.getSupportedTypes=function(){return[]},Guacamole.VideoPlayer.getInstance=function(e,t,n){return null}
